<!doctype html><html lang=en><head><title>From Zero to eBPF BNG in 15 Minutes: The GitOps Deployment Repo</title>
<meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><link rel=stylesheet href=/application.663be810443bfefbb9189da05c6ad91f18f642c9bd0ec9f91dd748f00871b9e1.css integrity="sha256-ZjvoEEQ7/vu5GJ2gXGrZHxj2Qsm9Dsn5HddI8AhxueE="><link rel=icon type=image/png href=/images/site/icon.svg><meta property="og:title" content="From Zero to eBPF BNG in 15 Minutes: The GitOps Deployment Repo"><meta property="og:description" content="The infrastructure repo that lets you run a complete eBPF-accelerated BNG stack locally with one command"><meta property="og:type" content="article"><meta property="og:url" content="/posts/ebpf-bng-infra/"><meta property="article:published_time" content="2026-01-24T00:00:00+00:00"><meta property="article:modified_time" content="2026-01-24T00:00:00+00:00"><meta property="article:section" content="posts"><meta property="article:tag" content="ebpf"><meta property="article:tag" content="gitops"><meta property="article:tag" content="kubernetes"><meta property="article:tag" content="tilt"><meta property="article:tag" content="k3d"><meta property="article:tag" content="isp"><meta name=twitter:card content="summary"><meta name=twitter:title content="From Zero to eBPF BNG in 15 Minutes: The GitOps Deployment Repo"><meta name=twitter:description content="The infrastructure repo that lets you run a complete eBPF-accelerated BNG stack locally with one command"><meta name=description content="The infrastructure repo that lets you run a complete eBPF-accelerated BNG stack locally with one command"><script async src="https://www.googletagmanager.com/gtag/js?id=G-2E1HN9XECT"></script><script>var dnt,doNotTrack=!1;if(null&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-2E1HN9XECT")}</script><script integrity="sha256-DO4ugzEwhTW1Id1UIWn0gUJWaebCYOypeTit6LW4QB4=">let theme=localStorage.getItem("theme-scheme")||localStorage.getItem("darkmode:color-scheme")||"light";theme==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?theme="dark":theme="light"),document.documentElement.setAttribute("data-theme",theme)</script></head><body class="type-posts kind-page" data-bs-spy=scroll data-bs-target=#TableOfContents data-bs-offset=80><div class="container-fluid bg-secondary wrapper"><nav class="navbar navbar-expand-xl top-navbar shadow" id=top-navbar><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button>
<i data-feather=sidebar></i>
</button>
<a class=navbar-brand href=/><img src=/images/site/icon.svg id=logo alt=Logo>
Marks Blog</a>
<button class="navbar-toggler navbar-light" id=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#top-nav-items aria-label=menu>
<i data-feather=menu></i></button><div class="collapse navbar-collapse dynamic-navbar" id=top-nav-items><ul class="nav navbar-nav ms-auto"><li class=nav-item><a class=nav-link href=/#home>Home</a></li><li class=nav-item><a class=nav-link href=/#about>About</a></li><li class=nav-item><a class=nav-link href=/#skills>Skills</a></li><li class=nav-item><a class=nav-link href=/#experiences>Experiences</a></li><li class=nav-item><a class=nav-link href=/#education>Education</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>More</a><div class=dropdown-menu aria-labelledby=navbarDropdown><a class=dropdown-item href=/#projects>Projects</a>
<a class=dropdown-item href=/#recent-posts>Recent Posts</a></div></li><div id=top-navbar-divider></div><li class=nav-item><a class=nav-link id=blog-link href=/posts>Posts</a></li><li class=nav-item><a class=nav-link href=/files/cv.pdf>CV</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg class=theme-icon src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a><div id=themeMenu class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# data-scheme=light><img class=theme-icon src=/icons/sun-svgrepo-com.svg width=20 alt="Light Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=dark><img class=theme-icon src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=system><img class=theme-icon src=/icons/computer-svgrepo-com.svg width=20 alt="System Theme"></a></div></li></ul></div></div><img src=/images/site/icon.svg class=d-none id=main-logo alt=Logo>
<img src=/images/site/icon.svg class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts/ data-filter=all>Posts</a></li><div class=subtree><li><a class=list-link href=/posts/ai-assisted-engineering/ title=ai-assisted-engineering>ai-assisted-engineering</a></li><li><a class=list-link href=/posts/ebpf-bng-production/ title=ebpf-bng-production>ebpf-bng-production</a></li><li><a class="active list-link" href=/posts/ebpf-bng-infra/ title=ebpf-bng-infra>ebpf-bng-infra</a></li><li><a class=list-link href=/posts/ebpf-bng/ title=ebpf-bng>ebpf-bng</a></li><li><a class=list-link href=/posts/gitops/ title=gitops>gitops</a></li><li><a class=list-link href=/posts/socat/ title=socat>socat</a></li><li><a class=list-link href=/posts/gitops-pr-diffs/ title=gitops-pr-diffs>gitops-pr-diffs</a></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(/posts/ebpf-bng-infra/hero.png)></div><div class=page-content><div class="author-profile ms-auto align-self-lg-center"><img class=rounded-circle src=/images/author/profile_hu_af83896b90796b7f.jpg alt="Author Image"><h5 class=author-name>Mark Gascoyne</h5><p class=text-muted>Saturday, January 24, 2026 | 9 minutes</p></div><div class=title><h1>From Zero to eBPF BNG in 15 Minutes: The GitOps Deployment Repo</h1></div><div class=tags><ul style=padding-left:0><li class=rounded><a href=/tags/ebpf/ class="btn btn-sm btn-info">ebpf</a></li><li class=rounded><a href=/tags/gitops/ class="btn btn-sm btn-info">gitops</a></li><li class=rounded><a href=/tags/kubernetes/ class="btn btn-sm btn-info">kubernetes</a></li><li class=rounded><a href=/tags/tilt/ class="btn btn-sm btn-info">tilt</a></li><li class=rounded><a href=/tags/k3d/ class="btn btn-sm btn-info">k3d</a></li><li class=rounded><a href=/tags/isp/ class="btn btn-sm btn-info">isp</a></li><li class=rounded><a href=/tags/networking/ class="btn btn-sm btn-info">networking</a></li></ul></div><div class=post-content id=post-content><p>Last week I <a href=/posts/ebpf-bng/>open-sourced the eBPF BNG</a> itself. The response was great, but the most common question was: <em>&ldquo;How do I actually run this thing?&rdquo;</em></p><p>Fair question. The BNG repo has a Dockerfile and some example configs, but spinning up a distributed system with multiple components, observability, and realistic test traffic isn&rsquo;t trivial. That&rsquo;s the hard part of infrastructure - not writing the code, but figuring out how to deploy it, test it, and debug it when things break.</p><p>So this week I&rsquo;m open-sourcing the infrastructure repo: <strong>bng-edge-infra</strong>. One command gets you a complete eBPF BNG stack running locally.</p><h2 id=the-problem-works-on-my-machine-doesnt-scale>The Problem: &ldquo;Works On My Machine&rdquo; Doesn&rsquo;t Scale</h2><p>When I was building the BNG, I spent more time on deployment tooling than I&rsquo;d like to admit. The challenges:</p><ol><li><p><strong>Multiple components with dependencies</strong> - BNG needs Nexus for IP allocation. Nexus nodes need to discover each other. Everything needs networking configured correctly.</p></li><li><p><strong>No hardware to test on</strong> - Real OLTs cost thousands. You can&rsquo;t ask contributors to buy one to test a PR.</p></li><li><p><strong>Distributed systems are hard to debug</strong> - When a DHCP request fails, is it the eBPF program? The userspace fallback? Nexus? Network policy? You need visibility.</p></li><li><p><strong>The &ldquo;getting started&rdquo; cliff</strong> - Vendor docs assume you already understand the system. They show you config snippets, not working examples.</p></li></ol><p>The solution: a GitOps repo that codifies everything - from cluster creation to traffic testing - in a reproducible, one-command experience.</p><h2 id=whats-in-the-repo>What&rsquo;s In The Repo</h2><pre tabindex=0><code>bng-edge-infra/
├── clusters/
│   ├── local-dev/       # k3d cluster config
│   ├── staging/         # Staging Flux manifests
│   └── production/      # Production Flux manifests
├── components/
│   ├── base/            # Reusable base components
│   │   ├── bng/         # BNG deployment template
│   │   ├── nexus/       # Nexus StatefulSet template
│   │   ├── nexus-p2p/   # Nexus P2P cluster template
│   │   └── rendezvous-server/  # P2P discovery server
│   ├── demos/           # Demo overlays
│   │   ├── standalone/  # Demo A
│   │   ├── single/      # Demo B
│   │   ├── p2p-cluster/ # Demo C
│   │   └── distributed/ # Demo D
│   ├── bngblaster/      # Traffic generator
│   └── ...              # Test components
├── charts/              # Infrastructure (Cilium, Prometheus, Grafana)
├── src/
│   ├── bng/             # SUBMODULE: BNG source
│   └── nexus/           # SUBMODULE: Nexus source
└── Tiltfile             # The magic
</code></pre><p>The key insight is treating the <em>entire deployment experience</em> as code. Not just the Kubernetes manifests, but the cluster creation, the infrastructure setup, the port forwarding, and the test harnesses.</p><h2 id=four-demo-configurations>Four Demo Configurations</h2><p>The repo ships with four progressively complex deployment modes. Each one teaches you something different about the architecture:</p><pre tabindex=0><code>┌─────────────────────────────────────────────────────────────────────┐
│  Demo A: Standalone BNG                                             │
│  ┌─────────┐                                                        │
│  │   BNG   │  ← Single BNG, local IP pool, no external deps        │
│  └─────────┘                                                        │
│  Good for: Understanding BNG internals, eBPF debugging              │
└─────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────┐
│  Demo B: Single Integration                                         │
│  ┌─────────┐      ┌─────────┐                                       │
│  │  Nexus  │ ←──→ │   BNG   │  ← BNG gets IPs from Nexus           │
│  └─────────┘      └─────────┘                                       │
│  Good for: Testing the integration, API exploration                 │
└─────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────┐
│  Demo C: Nexus P2P Cluster                                          │
│  ┌─────────┐   ┌─────────┐   ┌─────────┐                            │
│  │ Nexus-0 │ ↔ │ Nexus-1 │ ↔ │ Nexus-2 │  ← CRDT sync via libp2p          │
│  └─────────┘   └─────────┘   └─────────┘                            │
│  Good for: Testing distributed state, partition tolerance           │
└─────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────┐
│  Demo D: Full Distributed                                           │
│  ┌─────────┐   ┌─────────┐   ┌─────────┐                            │
│  │ Nexus-0 │ ↔ │ Nexus-1 │ ↔ │ Nexus-2 │                            │
│  └────┬────┘   └────┬────┘   └────┬────┘                            │
│       │             │             │                                  │
│       └──────┬──────┴──────┬──────┘                                  │
│              ▼             ▼                                         │
│         ┌─────────┐   ┌─────────┐                                    │
│         │  BNG-0  │   │  BNG-1  │  ← Multiple BNGs, shared state    │
│         └─────────┘   └─────────┘                                    │
│  Good for: Production-like testing, HA validation                   │
└─────────────────────────────────────────────────────────────────────┘
</code></pre><p>You can run any specific demo or all of them at once:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tilt up                  <span style=color:#75715e># Shows available groups</span>
</span></span><span style=display:flex><span>tilt up demo-a           <span style=color:#75715e># Just standalone BNG</span>
</span></span><span style=display:flex><span>tilt up demo-d           <span style=color:#75715e># Just full distributed</span>
</span></span><span style=display:flex><span>tilt up demo-a demo-b    <span style=color:#75715e># Multiple demos</span>
</span></span><span style=display:flex><span>tilt up all              <span style=color:#75715e># Everything</span>
</span></span></code></pre></div><h2 id=the-one-command-experience>The One-Command Experience</h2><h3 id=prerequisites>Prerequisites</h3><p>You need Docker and about 8GB of RAM. Then install the tools:</p><p><strong>macOS:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>brew install k3d kubectl tilt-dev/tap/tilt
</span></span></code></pre></div><p><strong>Linux:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># k3d</span>
</span></span><span style=display:flex><span>curl -s https://raw.githubusercontent.com/k3d-io/k3d/main/install.sh | bash
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># kubectl</span>
</span></span><span style=display:flex><span>curl -LO <span style=color:#e6db74>&#34;https://dl.k8s.io/release/</span><span style=color:#66d9ef>$(</span>curl -L -s https://dl.k8s.io/release/stable.txt<span style=color:#66d9ef>)</span><span style=color:#e6db74>/bin/linux/amd64/kubectl&#34;</span>
</span></span><span style=display:flex><span>chmod +x kubectl <span style=color:#f92672>&amp;&amp;</span> sudo mv kubectl /usr/local/bin/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># tilt</span>
</span></span><span style=display:flex><span>curl -fsSL https://raw.githubusercontent.com/tilt-dev/tilt/master/scripts/install.sh | bash
</span></span></code></pre></div><h3 id=clone-and-run>Clone and Run</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git clone --recurse-submodules git@github.com:codelaboratoryltd/bng-edge-infra.git
</span></span><span style=display:flex><span>cd bng-edge-infra
</span></span><span style=display:flex><span>./scripts/init.sh    <span style=color:#75715e># Create k3d cluster (first time only)</span>
</span></span><span style=display:flex><span>tilt up demo-a       <span style=color:#75715e># Run standalone BNG demo</span>
</span></span></code></pre></div><p>That&rsquo;s it. Go make a coffee.</p><h3 id=what-happens-under-the-hood>What Happens Under The Hood</h3><p>The setup is split into two steps:</p><p><strong>First, <code>./scripts/init.sh</code> creates the k3d cluster:</strong></p><ul><li>A local Kubernetes cluster named <code>bng-edge</code> spins up</li><li>Flannel is disabled (we use Cilium instead)</li><li>A local Docker registry is created at <code>localhost:5555</code></li></ul><p><strong>Then, <code>tilt up &lt;group></code> does the rest:</strong></p><ol><li><p><strong>Cilium installation</strong> - The eBPF-based CNI is deployed via kustomize, enabling Hubble observability.</p></li><li><p><strong>Docker builds</strong> - BNG and Nexus images are built from the submodules and pushed to the local registry.</p></li><li><p><strong>Demo deployment</strong> - The selected demo components are deployed via kustomize. Each demo gets its own namespace (<code>demo-standalone</code>, <code>demo-single</code>, <code>demo-p2p</code>, <code>demo-distributed</code>).</p></li><li><p><strong>Port forwarding</strong> - Services are exposed to localhost automatically.</p></li><li><p><strong>Live reload</strong> - File changes trigger automatic rebuilds and redeployments.</p></li></ol><p>After a few minutes, you&rsquo;ll have:</p><table><thead><tr><th>Service</th><th>URL</th><th>Notes</th></tr></thead><tbody><tr><td>Tilt UI</td><td>http://localhost:10350</td><td>Always available</td></tr><tr><td>BNG API (Demo A)</td><td>http://localhost:8080</td><td><code>tilt up demo-a</code></td></tr><tr><td>Nexus API (Demo B)</td><td>http://localhost:9001</td><td><code>tilt up demo-b</code></td></tr><tr><td>BNG API (Demo D)</td><td>http://localhost:8083</td><td><code>tilt up demo-d</code></td></tr><tr><td>Hubble UI</td><td>http://localhost:12000</td><td><code>tilt up &lt;demo> infra</code></td></tr><tr><td>Prometheus</td><td>http://localhost:9090</td><td><code>tilt up &lt;demo> infra</code></td></tr><tr><td>Grafana</td><td>http://localhost:3000</td><td><code>tilt up &lt;demo> infra</code></td></tr></tbody></table><h2 id=testing-without-real-hardware>Testing Without Real Hardware</h2><p>One of the biggest challenges with BNG development is that you normally need real subscriber hardware to generate DHCP/PPPoE traffic. We solve this with built-in test harnesses.</p><h3 id=verification-buttons>Verification Buttons</h3><p>Each demo has a &ldquo;verify&rdquo; button in the Tilt UI. Click it to run a quick health check:</p><ul><li><strong>Demo A</strong>: Queries the BNG sessions API</li><li><strong>Demo B</strong>: Creates a pool in Nexus, allocates an IP, verifies the integration</li><li><strong>Demo C</strong>: Creates a pool on Nexus-0, waits for CRDT sync, verifies it appears on Nexus-1</li><li><strong>Demo D</strong>: Full integration test across the distributed cluster</li></ul><h3 id=bng-blaster>BNG Blaster</h3><p>For serious traffic testing, we include <a href=https://github.com/rtbrick/bngblaster target=_blank rel=noopener>BNG Blaster</a> - an open-source traffic generator designed for BNG testing:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tilt up blaster
</span></span></code></pre></div><p>This gives you pre-configured test scenarios:</p><ul><li>IPoE session establishment</li><li>PPPoE session establishment</li><li>DHCP stress testing</li></ul><h3 id=realistic-dhcp-testing>Realistic DHCP Testing</h3><p>For quick DHCP validation without BNG Blaster&rsquo;s complexity, there&rsquo;s a lightweight test harness:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tilt up blaster-test
</span></span></code></pre></div><p>This spins up a BNG with a sidecar container that can generate real DHCP traffic over a veth pair. The Tilt UI has buttons for:</p><ul><li><strong>Single DHCP request</strong> - One udhcpc request to verify basic functionality</li><li><strong>Stress test</strong> - 10 virtual clients requesting IPs concurrently</li><li><strong>Check sessions</strong> - Query the BNG API to see allocated sessions</li></ul><p>Example output from the stress test:</p><pre tabindex=0><code>=== Multi-Client DHCP Stress Test ===
Creating 10 virtual clients...
Running DHCP requests...
  Client 1: 10.100.0.2/24
  Client 2: 10.100.0.3/24
  Client 3: 10.100.0.4/24
  ...
=== Results ===
Successful: 10 / 10
Failed:     0
Duration:   3s
Rate:       3 sessions/sec
</code></pre><h2 id=observability-built-in>Observability Built In</h2><p>Debugging distributed systems without observability is misery. The repo comes with a full stack pre-configured.</p><h3 id=cilium--hubble>Cilium + Hubble</h3><p>We use Cilium as the CNI instead of the default Flannel. This gives us:</p><ul><li><strong>eBPF-based networking</strong> - Fitting, given the BNG itself uses eBPF</li><li><strong>Network policies</strong> - If you want to test isolation</li><li><strong>Hubble</strong> - Real-time network flow visibility</li></ul><p>The Hubble UI (http://localhost:12000) shows you every packet flowing through the cluster. When a DHCP request fails, you can see exactly where it got dropped.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Or use the CLI</span>
</span></span><span style=display:flex><span>hubble observe --namespace demo-distributed
</span></span><span style=display:flex><span>hubble observe --protocol udp --port <span style=color:#ae81ff>67</span>  <span style=color:#75715e># DHCP traffic only</span>
</span></span></code></pre></div><h3 id=prometheus--grafana>Prometheus + Grafana</h3><p>Both BNG and Nexus export Prometheus metrics. The repo includes:</p><ul><li>Pre-configured scrape configs</li><li>Basic dashboards for BNG session counts, DHCP latency, Nexus allocation rates</li></ul><p>Grafana is available at http://localhost:3000 (admin/admin).</p><h3 id=why-this-matters>Why This Matters</h3><p>When you&rsquo;re debugging &ldquo;DHCP isn&rsquo;t working&rdquo;, the question is always <em>where</em> in the stack it&rsquo;s failing:</p><ol><li>Is the packet reaching the BNG pod? → Hubble</li><li>Is the eBPF fast path matching? → BNG metrics (<code>dhcp_fastpath_hits</code>)</li><li>Is the slow path timing out on Nexus? → Nexus metrics + traces</li><li>Is the response getting back to the client? → Hubble again</li></ol><p>Having all of this in one place, with one command, makes the difference between debugging for hours and debugging for minutes.</p><h2 id=taking-it-to-production>Taking It To Production</h2><p>The local-dev setup is designed for experimentation, but the repo structure supports real deployments.</p><h3 id=staging-and-production-clusters>Staging and Production Clusters</h3><p>The <code>clusters/staging/</code> and <code>clusters/production/</code> directories are set up for FluxCD:</p><pre tabindex=0><code>clusters/
├── local-dev/
│   └── k3d-config.yaml
├── staging/
│   ├── flux-system/      # Flux bootstrap
│   ├── infrastructure/   # Cilium, monitoring
│   └── apps/             # BNG, Nexus
└── production/
    ├── flux-system/
    ├── infrastructure/
    └── apps/
</code></pre><p>Point Flux at the appropriate directory, and it&rsquo;ll keep your cluster in sync with Git. The same manifests that work locally work in production - that&rsquo;s the point of GitOps.</p><h3 id=extending-for-your-deployment>Extending For Your Deployment</h3><p>The demo configurations are intentionally simple. For a real deployment, you&rsquo;d add:</p><ol><li><strong>RADIUS integration</strong> - The BNG supports FreeRADIUS. Add your RADIUS server config.</li><li><strong>Real IP pools</strong> - Replace the <code>10.x.x.x</code> demo pools with your actual allocations.</li><li><strong>TLS everywhere</strong> - The demos use HTTP for simplicity. Production should use mTLS.</li><li><strong>Persistent storage</strong> - Nexus supports persistent state. Configure a StorageClass.</li><li><strong>Network interfaces</strong> - The demos use standard CNI networking. Real OLTs need interface configuration for subscriber-facing ports.</li></ol><h2 id=the-bigger-picture>The Bigger Picture</h2><p>This repo represents a philosophy: <strong>infrastructure should be runnable by anyone</strong>.</p><p>Too often, infrastructure projects assume you&rsquo;ll figure out deployment yourself. They give you a binary and some config flags and wish you luck. That&rsquo;s fine for simple tools, but distributed systems are different. The deployment <em>is</em> the product.</p><p>By open-sourcing not just the BNG code but the entire deployment experience, we&rsquo;re saying: this is how we think it should work. Clone it, run it, break it, improve it.</p><p>If you&rsquo;re building ISP infrastructure, evaluating the architecture, or just curious about GitOps patterns for edge systems - this is your starting point.</p><hr><p><strong>Try it:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git clone --recurse-submodules git@github.com:codelaboratoryltd/bng-edge-infra.git
</span></span><span style=display:flex><span>cd bng-edge-infra
</span></span><span style=display:flex><span>./scripts/init.sh    <span style=color:#75715e># Create k3d cluster</span>
</span></span><span style=display:flex><span>tilt up demo-a       <span style=color:#75715e># Run standalone BNG demo</span>
</span></span></code></pre></div><p><strong>Links:</strong></p><ul><li><a href=https://github.com/codelaboratoryltd/bng-edge-infra target=_blank rel=noopener>bng-edge-infra</a> - This repo</li><li><a href=https://github.com/codelaboratoryltd/bng target=_blank rel=noopener>bng</a> - The eBPF BNG itself</li><li><a href=https://github.com/codelaboratoryltd/nexus target=_blank rel=noopener>nexus</a> - Distributed coordination service</li></ul><p><em>Questions? Feedback? Found a bug? Open an issue or reach out.</em></p></div><div class="row ps-3 pe-3"><div class="col-md-6 share-buttons"><strong>Share on:</strong>
<a class="btn icon-button bg-facebook" href="https://www.facebook.com/sharer.php?u=%2fposts%2febpf-bng-infra%2f" target=_blank><i class="fab fa-facebook"></i>
</a><a class="btn icon-button bg-twitter" href="https://twitter.com/share?url=%2fposts%2febpf-bng-infra%2f&text=From%20Zero%20to%20eBPF%20BNG%20in%2015%20Minutes%3a%20The%20GitOps%20Deployment%20Repo&via=Marks%20Blog" target=_blank><i class="fab fa-twitter"></i>
</a><a class="btn icon-button bg-reddit" href="https://reddit.com/submit?url=%2fposts%2febpf-bng-infra%2f&title=From%20Zero%20to%20eBPF%20BNG%20in%2015%20Minutes%3a%20The%20GitOps%20Deployment%20Repo" target=_blank><i class="fab fa-reddit"></i>
</a><a class="btn icon-button bg-linkedin" href="https://www.linkedin.com/shareArticle?url=%2fposts%2febpf-bng-infra%2f&title=From%20Zero%20to%20eBPF%20BNG%20in%2015%20Minutes%3a%20The%20GitOps%20Deployment%20Repo" target=_blank><i class="fab fa-linkedin"></i>
</a><a class="btn icon-button bg-whatsapp" href="https://api.whatsapp.com/send?text=From%20Zero%20to%20eBPF%20BNG%20in%2015%20Minutes%3a%20The%20GitOps%20Deployment%20Repo %2fposts%2febpf-bng-infra%2f" target=_blank><i class="fab fa-whatsapp"></i>
</a><a class="btn icon-button" href="mailto:?subject=From%20Zero%20to%20eBPF%20BNG%20in%2015%20Minutes%3a%20The%20GitOps%20Deployment%20Repo&body=%2fposts%2febpf-bng-infra%2f" target=_blank><i class="fas fa-envelope-open-text"></i></a></div></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/posts/ebpf-bng-production/ title="The Unglamorous Work: Hardening an eBPF BNG for Production" class="btn filled-button"><div><i class="fas fa-chevron-circle-left"></i> Prev</div><div class=next-prev-text>The Unglamorous Work: Hardening an eBPF BNG for Production</div></a></div><div class="col-md-6 next-article"><a href=/posts/ebpf-bng/ title="Killing the ISP Appliance: An eBPF/XDP Approach to Distributed BNG" class="btn filled-button"><div>Next <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>Killing the ISP Appliance: An eBPF/XDP Approach to Distributed BNG</div></a></div></div><hr></div></div></div><a id=scroll-to-top class=btn type=button data-bs-toggle=tooltip data-bs-placement=left title="Scroll to top"><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center ps-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#the-problem-works-on-my-machine-doesnt-scale>The Problem: &ldquo;Works On My Machine&rdquo; Doesn&rsquo;t Scale</a></li><li><a href=#whats-in-the-repo>What&rsquo;s In The Repo</a></li><li><a href=#four-demo-configurations>Four Demo Configurations</a></li><li><a href=#the-one-command-experience>The One-Command Experience</a><ul><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#clone-and-run>Clone and Run</a></li><li><a href=#what-happens-under-the-hood>What Happens Under The Hood</a></li></ul></li><li><a href=#testing-without-real-hardware>Testing Without Real Hardware</a><ul><li><a href=#verification-buttons>Verification Buttons</a></li><li><a href=#bng-blaster>BNG Blaster</a></li><li><a href=#realistic-dhcp-testing>Realistic DHCP Testing</a></li></ul></li><li><a href=#observability-built-in>Observability Built In</a><ul><li><a href=#cilium--hubble>Cilium + Hubble</a></li><li><a href=#prometheus--grafana>Prometheus + Grafana</a></li><li><a href=#why-this-matters>Why This Matters</a></li></ul></li><li><a href=#taking-it-to-production>Taking It To Production</a><ul><li><a href=#staging-and-production-clusters>Staging and Production Clusters</a></li><li><a href=#extending-for-your-deployment>Extending For Your Deployment</a></li></ul></li><li><a href=#the-bigger-picture>The Bigger Picture</a></li></ul></nav></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-start"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=/#about>About</a></li><li class=nav-item><a class=smooth-scroll href=/#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=/#experiences>Experiences</a></li><li class=nav-item><a class=smooth-scroll href=/#projects>Projects</a></li><li class=nav-item><a class=smooth-scroll href=/#education>Education</a></li><li class=nav-item><a class=smooth-scroll href=/#recent-posts>Recent Posts</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><a href=mailto:contact@markgascoyne.co.uk target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>contact@markgascoyne.co.uk</span></a></li><li><span>Location: </span><span>United Kingdom</span></li><li><a href=tel:+44%207951553010 target=_blank rel=noopener><span><i class="fas fa-phone-alt"></i></span> <span>+44 7951553010</span></a></li></ul></div></div></div><hr><div class=container><div class="row text-start"><div class=col-md-4><a id=theme href=https://github.com/hugo-toha/toha target=_blank rel=noopener><img src=/images/theme-logo_hu_b3360284c55cf72d.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">© 2020 Copyright.</div><div class="col-md-4 text-end"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script src=/application.13bc872e6738e7032ba913080be67184a0bc5cb6b8def26d338d9970e2e1f127.js integrity="sha256-E7yHLmc45wMrqRMIC+ZxhKC8XLa43vJtM42ZcOLh8Sc=" defer></script></body></html>